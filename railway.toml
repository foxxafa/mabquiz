[build]
builder = "dockerfile"
dockerfilePath = "backend/Dockerfile"

[deploy]
numReplicas = 1
sleepApplication = false
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[env]
PORT = "8000"
ENVIRONMENT = "production"
DATABASE_URL = "${{DATABASE_URL}}"
PYTHONPATH = "/app"

[[services.deploy]]
startCommand = "gunicorn app.main:app --bind 0.0.0.0:$PORT --workers 2 --worker-class uvicorn.workers.UvicornWorker"